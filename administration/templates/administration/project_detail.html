{% extends 'website/base.html' %}

{% block custom_css %}
<style type="text/css">
thead {
  background-color: var(--secondary-color);
}

.sub-heading {
  background-color: var(--primary-color);
  color: white;
  font-weight: bold;
}

h2 > i:first-child {
  margin-left: 25px;
}
</style>
{% endblock custom_css %}

{% block content %}
<div class="container">
  <h2>
    {{ project }}
    <i class="fas fa-pencil-alt" data-toggle="tooltip" title="Edit Project"></i>
    <i class="fas fa-ticket-alt" data-toggle="tooltip" title="Add coupon"></i>
    <i href="{% url 'administration:financial_summary' pk=project.pk %}" class="fas fa-dollar-sign" data-toggle="tooltip" title="Financial Summary"></i>
    <i class="far fa-trash-alt" data-toggle="tooltip" title="Delete Project"></i>
    <button class="btn btn-danger" style="float:right;">Back</button>
  </h2>
  <table class="table">
      <thead>
        <tr>
          <th class="center" colspan="2">
            Posts
            <i id='add-post' class="fas fa-plus"></i>
          </th>
        </tr>
      </thead>
      <tbody>
        <tr class="sub-heading">
          <td>Name</td>
          <td>Topic</td>
        </tr>
        {% for post in project.get_posts %}
        <tr>
          <td><a href="{% url 'posting:update_post' pk=post.pk %}">{{ post }}</a></td>
          <td>{{ post.topic }}</td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="2">There are currently no posts for this project.</td>
        </tr>
        {% endfor %}
      </tbody>
  </table>
</div>
{% endblock content %}

{% block js %}
<script>
$('.btn-danger').click(function() {
  window.location.href = "{% url 'administration:homepage' %}";
});

$('.fa-pencil-alt').click(function() {
  window.location.href = "{% url 'administration:update_project' pk=project.pk %}";
});

$('.fa-trash-alt').click(function() {
  if(confirm("Are you sure you want to delete this project?")) {
    window.location.href = "{% url 'administration:delete_project' pk=project.pk %}";
  }
});

$('#add-post').click(function() {
  window.location.href = "{% url 'posting:add_post' pk=project.pk %}";
});

$('.fa-ticket-alt').click(function() {
  window.open("{{ project.add_coupon_url }}", '_blank');
});

$('.fa-dollar-sign').click(function() {
  window.location.href = $(this).attr('href');
});
</script>
{% endblock js %}
