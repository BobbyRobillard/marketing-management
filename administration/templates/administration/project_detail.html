{% extends 'website/base.html' %}

{% block custom_css %}
<style type="text/css">
thead {
  background-color: var(--secondary-color);
}

.sub-heading {
  background-color: var(--primary-color);
  color: white;
  font-weight: bold;
}

h2 > i:first-child {
  margin-left: 25px;
}
</style>
{% endblock custom_css %}

{% block content %}
<div class="container">
  <h2>
    {{ project }}
    <i class="fas fa-pencil-alt" data-toggle="tooltip" title="Edit Project"></i>
    <i href="{% url 'administration:financial_summary' pk=project.pk %}" class="fas fa-dollar-sign" data-toggle="tooltip" title="Financial Summary"></i>
    <i class="far fa-trash-alt" data-toggle="tooltip" title="Delete Project"></i>
  </h2>
  <table class="table">
      <thead>
        <tr>
          <th class="center" colspan="5">
            Posts
            <i id='add-post' class="far fa-plus-square"></i>
          </th>
        </tr>
      </thead>
      <tbody>
        <tr class="sub-heading">
          <td>Name</td>
          <td>Location</td>
          <td>
            Topic
            <i class="far fa-plus-square"></i>
          </td>
          <td>Posted</td>
          <td></td>
        </tr>
        {% for post in project.get_posts %}
        <tr>
          <td><a href="{% url 'posting:update_post' pk=post.pk %}">{{ post }}</a></td>
          <td>{{ post.url }}</td>
          <td>{{ post.topic }}</td>
          <td>{{ post.posted }}</td>
          <td>
            <i href="{% url 'posting:add_codes_to_post' pk=post.pk %}" class="fas fa-ticket-alt" data-toggle="tooltip" title="Manage promotion codes"></i>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="3">There are currently no posts for this project.</td>
        </tr>
        {% endfor %}
      </tbody>
  </table>
  <button class="btn btn-danger">Back</button>
</div>
{% endblock content %}

{% block js %}
<script>
$('.btn-danger').click(function() {
  window.location.href = "{% url 'administration:homepage' %}";
});

$('.fa-pencil-alt').click(function() {
  window.location.href = "{% url 'administration:update_project' pk=project.pk %}";
});

$('.fa-trash-alt').click(function() {
  if(confirm("Are you sure you want to delete this project?")) {
    window.location.href = "{% url 'administration:delete_project' pk=project.pk %}";
  }
});

$('#add-post').click(function() {
  window.location.href = "{% url 'posting:add_post' pk=project.pk %}";
});

$('.fa-ticket-alt').click(function() {
  window.location.href = $(this).attr('href');
});

$('.fa-dollar-sign').click(function() {
  window.location.href = $(this).attr('href');
});
</script>
{% endblock js %}
